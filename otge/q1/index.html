<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <title>音ゲー</title>
  </head>
  <body>
      <div id="start">
        Demo
      </div>
      <div id="game">
        Start
      </div>

      <video id="video" src="ad.mp4" muted></video>
  </body>
</html>

<style>
  #start {
    border:5px solid black;
    width:90px;
    height:90px;
    margin:0
    }
  #game {
    border:5px solid black;
    width:90px;
    height:90px;
    margin:0
    }
</style>

<script>
window.addEventListener("keydown", function (event) {
  if (event.defaultPrevented) {
    return; // デフォルトのアクションがキャンセルされている場合は何もしないようにします。
  }
  console.log(count,event.keyCode)
  var handled = false;
  if (event.keyCode == 75 ) {
    // if( 320 < count && count <= 680 ){
    //   maru.play()
    // }else if( 500 < count && count <= 1340){
    //   maru.play()
    // }else if( 2160 < count && count <= 2830 ){
    //   maru.play()
    // }else if( 2500 < count && count <= 3160 ){
    //   maru.play()
    // }else if( 4160 < count && count <= 5000 ){
    //   maru.play()
    // }else if( 5160 < count && count <= 6000 ){
    //   maru.play()
    // }else if( 5830 < count && count <= 6670 ){
    //   maru.play()
    // }else if( 6500 < count && count <= 7340 ){
    //   maru.play()
    // }else if( 9330 < count && count <= 10000 ){
    //   maru.play()
    // }else if( 9660 < count && count <= 11000 ){
    //   maru.play()
    // }else if( 1190 < count && count <= 2000 ){
      maru.play()
    // }
  }else if (event.keyCode == 79 ) {
    // if(0 <= count && count <= 320 ){
    //   batsu.play()
    // }else if( 180 < count && count <= 1000){
    //   batsu.play()

    // }else if( 840< count && count <= 1680){
    //   batsu.play()

    // }else if( 1500 < count && count <= 2330){
    //   batsu.play()

    // }else if( 2000 < count && count <= 2660){
    //   batsu.play()

    // }else if( 4833 < count && count <= 5660 ){
    //   batsu.play()

    // }else if( 5500 < count && count <= 6340 ){
    //   batsu.play()

    // }else if( 6170 < count && count <= 7000 ){
    //   batsu.play()

    // }else if( 6840 < count && count <= 7660 ){
    //   batsu.play()

    // }else if( 8500 < count && count <= 9165 ){
    //   batsu.play()

    // }else if( 8833 < count && count <= 9883 ){
      batsu.play()
    // }

  }else if (event.keyCode == 77 ) {
    // if(3500 < count && count <= 4300 ){
      san.play()
    // }
  }else if (event.keyCode == 73 ) {
    // if(8000 < count && count <= 8660 ){
      kaku.play()
    // }
  }else if (event.keyCode == 74 ) {
    // if( 3180 < count && count <= 3830 ){
    //   migi.play()
    // }else if(3830 < count && count <= 4660){
      migi.play()
    // }
  }else if (event.keyCode == 78 ) {
    // if( 7500 < count && count <= 8160 ){
    //   shita.play()
    // }else if( 7830 < count && count <= 8500 ){
    //   shita.play()
    // }else if( 8165 < count && count <= 8833 ){
      shita.play()
    // }
  }else if (event.keyCode == 81 ) {
    // if( 2340 < count && count <= 3000 ){
    //   left.play()
    // }else if( 3330 < count && count <= 4000 ){
    //   left.play()
    // }else if(9500 < count && count <=	10165){
      left.play()
    // }
  }else if (event.keyCode == 65 ) {
    // if( 7660 < count && count <= 8330 ){
    //   ue.play()
    // }else if( 8330 < count && count <= 9000 ){
      ue.play()
    // }
  }else if (event.keyCode == 90 ) {
    // if( 2670 < count && count <= 3330 ){
      l2.play()
    // }
  }else if (event.keyCode == 87 ) {
    // if( 2830 < count && count <= 3670 ){
      r2.play()
    // }
  }

  if (handled) {
    event.preventDefault();
  }
}, true);

var music = new Audio('ado_back.wav');
var play_m = new Audio('ado_player.wav');
var count_m = new Audio('count.mp3');

var batsu = new Audio('adomaru.wav');
var maru = new Audio('adobatsu.wav');
var san = new Audio('adosan.wav');
var kaku = new Audio('adokaku.wav');
var ue = new Audio('adoue.wav');
var shita = new Audio('adoshita.wav');
var migi = new Audio('adoright.wav');
var left = new Audio('adoleft.wav');
var r2 = new Audio('ador2.wav');
var l2 = new Audio('adol2.wav');
var v = document.getElementById("video");

let count = 0;
audio_first = false

play_btn = document.getElementById("start");
play_btn.addEventListener( 'click' , play );

game_btn = document.getElementById("game");
game_btn.addEventListener( 'click' , playgame );


function play(){
  count_m.play()
  count_m.addEventListener('ended', (event) => {
    music.volume = 0.1
    play_m.volume = 0.3
    music.play();
    v.play();
    play_m.play()
    audio_first = true
  });
}


function playgame(){
  count_m.play()
  count_m.addEventListener('ended', (event) => {
    music.volume = 0.1
    music.play();
    v.play();
    audio_first = true  
  });
}

const countUp = () =>{
    count = count+10
}


const intervalId = setInterval(() =>{
    if(audio_first == true){
        countUp();
        if(count > 10000){　
            clearInterval(intervalId);　//intervalIdをclearIntervalで指定している
        }
    }
},10);
</script>